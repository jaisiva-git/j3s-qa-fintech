<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Mock UI - Fintech</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .card { border: 1px solid #ddd; padding: 16px; border-radius: 8px; margin-bottom: 16px; }
  </style>
</head>
<body>
  <h1 data-testid="app-title">Mock Fintech UI</h1>
  <p id="status" data-testid="status-message"></p>

  <div class="card">
    <h2>Create User</h2>
    <label>Name <input id="user-name" data-testid="user-name"/></label><br/><br/>
    <label>Email <input id="user-email" type="email" data-testid="user-email"/></label><br/><br/>
    <label>Account Type 
      <select id="user-accountType" data-testid="user-accountType">
        <option value="standard">standard</option>
        <option value="premium">premium</option>
      </select>
    </label><br/><br/>
    <button id="btn-create-user" data-testid="btn-create-user">Create User</button>
  </div>

  <div class="card">
    <h2>Transfer</h2>
    <label>Sender userId <input id="tx-userId" data-testid="tx-userId"/></label><br/><br/>
    <label>Recipient userId <input id="tx-recipientId" data-testid="tx-recipientId"/></label><br/><br/>
    <label>Amount <input id="tx-amount" type="number" step="0.01" min="0.01" data-testid="tx-amount" value="10"/></label><br/><br/>
    <button id="btn-create-tx" data-testid="btn-create-tx">Send</button>
  </div>

  <script>
    const backend = new URLSearchParams(location.search).get('backend') || 'http://localhost:8080';
    async function createUser() {
      const body = {
        name: document.getElementById('user-name').value,
        email: document.getElementById('user-email').value,
        accountType: document.getElementById('user-accountType').value
      };
      const res = await fetch(backend + '/api/users', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(body)
      });
      const json = await res.json();
      document.getElementById('status').textContent = json.message || (json.success ? 'Created' : 'Error');
      return json;
    }

    async function createTx() {
      const body = {
        userId: document.getElementById('tx-userId').value,
        recipientId: document.getElementById('tx-recipientId').value,
        amount: Number(document.getElementById('tx-amount').value),
        type: 'transfer'
      };
      const res = await fetch(backend + '/api/transactions', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(body)
      });
      const json = await res.json();
      document.getElementById('status').textContent = json.message || (json.success ? 'Transfer ok' : 'Error');
      return json;
    }

    document.getElementById('btn-create-user').addEventListener('click', createUser);
    document.getElementById('btn-create-tx').addEventListener('click', createTx);
  </script>
</body>
</html>